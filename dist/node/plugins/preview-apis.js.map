{"version":3,"sources":["../../../src/plugins/preview-apis.js"],"names":["PREVIEW_HEADERS","require","DEFAULT_HEADER","url","key","val","test","module","exports","input","path","acceptHeader","headers","Promise","resolve"],"mappings":";;;;;;AAAA,IAAMA,kBAAkBC,QAAQ,4BAAR,CAAxB;;AAEA,IAAIC,iBAAiB,SAAjBA,cAAiB,CAAUC,GAAV,EAAe;AAClC,OAAK,IAAIC,GAAT,IAAgBJ,eAAhB,EAAiC;AAC/B,QAAIK,MAAML,gBAAgBI,GAAhB,CAAV;AACA,QAAIC,IAAIC,IAAJ,CAASH,GAAT,CAAJ,EAAmB;AAAE,aAAOC,GAAP;AAAY;AAClC;AACF,CALD;;AAOA;AACAG,OAAOC,OAAP,GAAiB;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,2CACSC,KADT,EACgB;AAAA,UACxBC,IADwB,GAChBD,KADgB,CACxBC,IADwB;;AAE7B,UAAIC,eAAeT,eAAeQ,IAAf,CAAnB;AACA,UAAIC,YAAJ,EAAkB;AAChBF,cAAMG,OAAN,CAAc,QAAd,IAA0BD,YAA1B;AACD;;AAED,aAAOE,QAAQC,OAAR,CAAgBL,KAAhB,CAAP;AACD;AATc;;AAAA;AAAA,MAAjB","file":"preview-apis.js","sourcesContent":["const PREVIEW_HEADERS = require('../grammar/preview-headers')\n\nlet DEFAULT_HEADER = function (url) {\n  for (let key in PREVIEW_HEADERS) {\n    let val = PREVIEW_HEADERS[key]\n    if (val.test(url)) { return key }\n  }\n}\n\n// Use the preview API header if one of the routes match the preview APIs\nmodule.exports = new class PreviewApis {\n  requestMiddlewareAsync (input) {\n    let {path} = input\n    let acceptHeader = DEFAULT_HEADER(path)\n    if (acceptHeader) {\n      input.headers['Accept'] = acceptHeader\n    }\n\n    return Promise.resolve(input)\n  }\n}()\n"]}